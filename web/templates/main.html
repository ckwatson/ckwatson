<!DOCTYPE html>
<html lang="en">

<head>
    {% include "_favicon.html" %}
    <title>CKWatson - {{ mode }}</title>
    <link href="/static/css/main.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" />
</head>

<body class="unselectable">
    <header class="navbar navbar-expand-lg bg-light">
        <nav class="container-xxl flex-wrap flex-lg-nowrap">
            <span class="navbar-brand mb-0 h1">
                <img src="/static/favicon/favicon-96x96.png" alt="Logo" width="24" height="24" class="d-inline-block align-text-top">
                CKWatson
            </span>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/">Index</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/create">Create
                          <span class="badge rounded-pill bg-warning">
                            WIP
                            <span class="visually-hidden">work in progress</span>
                          </span>
                        </a>
                    </li>
                </ul>
                <div class="nav-item ms-md-auto">
                    <a class="nav-link" href="https://github.com/ckwatson/ckwatson">
                       <img src="/static/github.svg" alt="GitHub Logo" width="24" height="24">
                    </a>
                </div>
            </div>
      </nav>
    </header>
    <div class="container pt-4" id="controlPanel">
        <div class="row pt-2">
            <div class="col-12">
                <h1>CKWatson - {{mode}}</h1>
            </div>
        </div>
        <div class="row pt-3 pb-2" id="instruction">
            {% if mode == "play" %}
            <div class="col-12">
                <p>
                    Take a look at all the species available in this puzzle. Try coming up with as many elementary reactions as you can!
                </p>
                <p>
                    When you have composed at least one <a href="https://chem.libretexts.org/Bookshelves/Physical_and_Theoretical_Chemistry_Textbook_Maps/Supplemental_Modules_(Physical_and_Theoretical_Chemistry)/Kinetics/03%3A_Rate_Laws/3.02%3A_Reaction_Mechanisms/3.2.01%3A_Elementary_Reactions">elementary reaction</a> and all elementary reactions are balanced
                    (indicated by a faint green background behind those rows), the "Plot" button will be available.
                    Once you click it, we'll run the experiment in two ways: with the correct answer
                    (that is, all elementary reactions) and with your answer. Then, we will plot the results:
                    the correct answer will be shown in solid curves, while your answer will be shown in dashed curves.
                    You can then compare the two and see how well you did.
                </p>
                <p>
                    The experiments are conducted as if several species has been sitting in their own canister or beaker and then put together.
                    For these "starting species", you can specify the starting concentrations and temperatures of some species.
                    You can also tweak the "ambient" temperature of the reaction.
                </p>
                <p>
                    Since some species spontaneously react with itself, we will always run pre-equilibration for each of the starting species.
                    This will affect the starting concentrations of any species involved, so the curves may not start at the concentrations you specified.
                </p>
            {% elif mode == "create" %}
            <div class="col-12">
                    <p>Instructions for Creating a Puzzle:</p>
                    <ol>
                        <li>Enter all <b>elementary reactions</b> involved in your puzzle. Each row is a reaction. Use the <b>"Add another Elementary Reaction"</b> button as needed.</li>
                        <li>Ensure each reaction is <b>balanced</b> (row turns green). Only then can you proceed.</li>
                        <li>Click <b>Proceed...</b> to define the <b>species</b> (free energies, which are reagents, etc.).</li>
                        <li>Fill in the puzzle name and species details in the modal dialog.</li>
                        <li>Click <b>Save</b> to submit your puzzle. You will see a success or error message.</li>
                    </ol>
            {% endif %}
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <h3>Elementary Reactions</h3>
            </div>
        </div>
        <div class="row">
            <div class="col-{% if mode == "play" %}8{% elif mode == "create" %}12{% endif %}">
                    <table class="table table-hover" id="elementaryReactions">
                        <thead>
                            <tr>
                                {% if mode == "play" %} <th>Use</th> {% endif %}
                                <th>Reactant 1</th>
                                <th>+</th>
                                <th>Reactant 2</th>
                                <th>=</th>
                                <th>Product 1</th>
                                <th>+</th>
                                <th>Product 2</th>
                                <th>Controls</th>
                            </tr>
                        </thead>
                        <tbody id="elementaryReactionsTbody"></tbody>
                    </table>
                    <button class="btn btn-secondary" id="addElementaryReaction" style="width:100%" type="button">Add another Elementary Reaction</button>
                    {% if mode == "play" %}
                </div>
                <div class="col-md-4">
                    <table class="table table-hover table-striped" id="condition">
                        <thead>
                            <tr>
                                <td>Species</td>
                                <td>Concentration (mol)</td>
                                <td>Temperature (K)</td>
                            </tr>
                        </thead>
                        <tbody id="conditionTbody"></tbody>
                        <tfoot>
                            <tr>
                                <td>( â†‘ Draggable)</td>
                                <td>
                                    <input disabled checked type="checkbox">
                                    Pre-equilibrate
                                </td>
                                <td>
                                    React at
                                    <input id="reactionTemperature" type="number" value="300"> K.
                                </td>
                            </tr>
                        </tfoot>
                    </table>
                    <button class="btn btn-primary" disabled="true" id="plotButton" style="width:100%" type="button">Plot</button>
                    {% endif %}
                </div>
            </div>
        </div>
        {% if mode == "create" %}
        <div class="container" id="resultsPanel">
            <div class="row">
                <div class="col-12">
                    <h3>Control &amp; Result</h3>
                </div>
            </div>
            <div class="row">
                <div class="col-12">
                    <button class="btn btn-primary" id="proceedButton" style="width:100%" disabled="true" type="button" data-toggle="modal" data-target="#speciesModal">Proceed...</button>
                </div>
            </div>
        </div>
        <div class="modal fade" id="speciesModal" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title" id="myModalLabel">
                            <input id="puzzleName" class="form-control" placeholder="Name Your Puzzle Here..." value="Untitled Puzzle" pattern="^[\w\- ]+$" title="Use only letters, numbers, spaces, dashes, and underscores.">
                        </h4>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <table class="table table-hover table-striped" id="species">
                            <thead>
                                <tr>
                                    <th>Species Name</th>
                                    <th>Free Energy</th>
                                    <th>Reagent?</th>
                                </tr>
                            </thead>
                            <tbody id="speciesTbody"></tbody>
                        </table>
                    </div>
                    <div class="modal-footer">
                        <div class="input-group">
                            <input type="password" id="auth_code" class="form-control" placeholder="Auth Code...">
                            <div class="input-group-append">
                                <button type="button" id="saveButton" class="btn btn-primary">Save</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% elif mode == "play" %}
        <div class="container pt-5" id="container">
            <div class="row">
                <div class="col-12">
                    <h3>Results, Showing
                        <div class="btn-group" role="group" id="viewControl" aria-label="radio toggle button group">
                            <input type="radio" class="btn-check" name="viewType" value="individual" autocomplete="off" id="button_to_view_individual">
                            <label class="btn btn-outline-secondary" for="button_to_view_individual">Individual Figures</label>
                            <input type="radio" class="btn-check" name="viewType" value="combined" autocomplete="off" id="button_to_view_combined">
                            <label class="btn btn-outline-secondary" for="button_to_view_combined">Combined Figure</label>
                            <input type="radio" class="btn-check" name="viewType" value="info" autocomplete="off" id="button_to_view_info">
                            <label class="btn btn-outline-secondary" for="button_to_view_info">Messages</label>
                        </div>
                    </h3>
                </div>
            </div>
            <div class="row">
                <div class="col-12">
                    <ul id="result_nav" class="nav nav-tabs" role="tablist">
                    </ul>
                    <div id="result_panels" class="tab-content">
                    </div>
                </div>
            </div>
        </div>
        {% endif %}
        <script>
        var puzzleName = "{{ puzzleName }}";
        var ip = "{{ ip }}";
        {% if mode == "play" %}
        var puzzleData = {{ puzzleData | safe }};
        {% endif %}
        </script>
        <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js" integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/validator/13.5.2/validator.min.js" integrity="sha512-vZEoK8xRncku4g5GANHh5zobUjeCMbZkSEahrADeAcRlk/1Ignf8sAKojkV4RZLkPw145+ILJFisI2pnjsPtGQ==" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.20/lodash.min.js" integrity="sha512-90vH1Z83AJY9DmlWa8WkjkV79yfS2n2Oxhsi2dZbIv0nC4E6m5AbH8Nh156kkM7JePmqD6tcZsfad1ueoaovww==" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/blueimp-md5/2.18.0/js/md5.min.js" integrity="sha512-Hmp6qDy9imQmd15Ds1WQJ3uoyGCUz5myyr5ijainC1z+tP7wuXcze5ZZR3dF7+rkRALfNy7jcfgS5hH8wJ/2dQ==" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.10.2/Sortable.min.js" integrity="sha512-ELgdXEUQM5x+vB2mycmnSCsiDZWQYXKwlzh9+p+Hff4f5LA+uf0w2pOp3j7UAuSAajxfEzmYZNOOLQuiotrt9Q==" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/prism.min.js" integrity="sha512-9+422Bs3A87UkWfp+qV80Nfv9arhbCXKY1rxrF2seorI36mIIstMiuBfyKLF1yH1nnzQkEWq2xrzT4XU3Z+vrA==" crossorigin="anonymous" data-manual></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/cheet.js/0.3.3/cheet.min.js" integrity="sha512-mfL/D2MUCTnRtquEsJNc3eFKmyDdzYJlQICtsookWdp44261VyRX5fUvsNWr0AtdFTY9+hCYHlcfc5XDZ3n7TQ==" crossorigin="anonymous"></script>
        {% if mode == "create" %}
        <script type="module" src="/static/js/create.js"></script>
        {% elif mode == "play" %}
        <script type="module" src="/static/js/play.js"></script>
        {% endif %}
</body>

</html>
